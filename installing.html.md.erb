---
title: Installing and Configuring PCF Healthwatch
owner: PCF Healthwatch
---

This topic describes how to install and configure Pivotal Cloud Foundry (PCF) Healthwatch. For a list of compatible Ops Manager and Pivotal Application Service (PAS) versions, see [Product Snapshot](index.html#snapshot).

##<a id='install'></a> Install PCF Healthwatch

1. Download the product file from [Pivotal Network](https://network.pivotal.io/products/p-healthwatch).

1. Navigate to the Ops Manager Installation Dashboard and click **Import a Product** to upload the product file.

1. Under the **Import a Product** button, click **+** next to the version number of PCF Healthwatch.
This adds the tile to your staging area.

##<a id='configure'></a> Configure PCF Healthwatch

To start using PCF Healthwatch, you need to configure the Ops Manager Director and PCF Healthwatch tiles.

<p class="note"><strong>Note</strong>: PCF Healthwatch requires a service network for running BOSH health checks. This ensures that Ops Manager will not attempt to use the same IP address as the BOSH Health Check VM.</p>

If you do not have an existing service network with IP addresses managed by BOSH and at least one free IP address, proceed to [Step 1. Configure the Ops Manager Director Tile](installing.html#ops-man) to create a new service network.

If you have an existing service network with IP addresses managed by BOSH and at least one free IP address, you can skip Step 1 and select this network for running the BOSH Health Check VM in [Step 2. Configure the PCF Healthwatch Tile](installing.html#healthwatch-tile).

###<a id='ops-man'></a> Step 1. Configure the Ops Manager Director Tile

<p class="note"><strong>Note</strong>: If you have already completed this step during a prior installation of PCF Healthwatch, you do not need to repeat it.</p>

To configure the Ops Manager Director tile, perform the following steps:

1. Click the **Ops Manager Director** tile on the Ops Manager Installation Dashboard.
1. Navigate to **Create Networks** and click **Add Network**.
1. In the **Name** field, enter a name for the service network.
1. Select the **Service Network** checkbox.
1. Enter the network details for your **Service Network**.
1. Click **Save**.
              
###<a id='healthwatch-tile'></a> Step 2. Configure the PCF Healthwatch Tile

To configure the PCF Healthwatch tile, perform the following steps:

1. Click the **PCF Healthwatch** tile on the Ops Manager Installation Dashboard.
1. Navigate to **Assign AZs and Networks** and do the following:
    1. Select an Availability Zone (AZ) for placing singleton jobs.
    1. Select one or more AZs for balancing other jobs.

		<p class="note"><strong>Note</strong>: To create a highly available environment, Pivotal recommends selecting multiple AZs.</p>

    1. Select **Network** for installing PCF Healthwatch.
    1. Select **Service Network** for running the BOSH Health Check VM.
    1. Click **Save**.

1. Navigate to **Healthwatch Component Config** and do the following:      
    1. (Optional) Enter a foundation name for this PCF. The entered name is emitted as a tag on all Firehose metrics generated by PCF Healthwatch. If no name is set, then PCF Healthwatch defaults to using the system domain as the foundation name label when publishing its metrics. Do not use any of the special characters `!`, `@`, `#`, `^`, `&`, `$`, `%` , `*`, parentheses or quotes in the chosen name. Use of `-`, `_` or space is allowed. 
	1. Set **Ingestor Count** to the number of Doppler Server instances configured in the PAS tile.
	1. Set **MySQL Loader Count** to 4 for a small or medium PCF deployment or a number equivalent to the number of Dopplers for a larger PCF deployment.
		<p class="note"><strong>Note</strong>: Pivotal recommends starting with the configuration above and then evaluating performance using the <a href="./monitoring.html#firehoseDisconnectMetrics">Ingestor</a> and <a href="./monitoring.html#loaderDroppedMetrics">Loader</a> metrics.<br/><br/>
		    In the default highly available installation, PCF Healthwatch requires up to 12 GB of free RAM on Diego for steady-state operations and up to 23 GB of RAM during deployments.  This footprint can be lowered by reducing the instance counts in this section. <br/>
		    Failure to have enough available RAM on Diego typically results in the <a href='./troubleshooting.html#insufficient-resources'>Insufficent Resources</a> error message when running the <b>push-apps</b> errand.
		</p>
	1. Click **Save**.

1. Navigate to **Health Check** and do the following:

	1. Enter **Ops Manager URL**. The URL should include the protocol.  This URL must be reachable from a `cf pushed` application.
	1. In **BOSH Health Check Availability Zone**, select an AZ for the BOSH Health Check VM.

	<p class="note"><strong>Note</strong>: On Azure environments this dropdown will be null as Azure does not yet have the concept of AZs.</p>

	1. In **BOSH Health Check VM Type**, select a VM type for the BOSH Health Check VM. The recommended VM type is **small**.
	1. Click **Save**.

1. Return to the Ops Manager Installation Dashboard and click **Apply Changes**.

##<a id='healthwatch-opsman'></a> (Optional) Disable Ops Manager Continuous Validation Testing

PCF Healthwatch continuously validates the health of Ops Manager. You may want to disable this test suite if, for example, you are using BOSH instead of Ops Manager to deploy PCF software. This can be accomplished either via the Ops Manager UI or BOSH manifest.

To disable the Ops Manager test suite via Ops Manager UI (an option available as of v1.1.4), do the following:

1. Click the **PCF Healthwatch** tile on the Ops Manager Installation Dashboard.
1. Navigate to **Health Check** section.
1. Select the **Disable** radio button in the **Ops Manager Validation Testing** field.

To disable the Ops Manager test suite via BOSH manifest, do the following:

1. In your BOSH manifest, set the `healthchecker.opsman.disable` property to `true`.
1. Redeploy PCF Healthwatch and run the <code>push-apps</code> errand.

When you turn the test suite off, the following changes happen:

* The `opsmanager-health-check` testing app is not deployed.
* The Ops Manager Health panel is not displayed in the PCF Healthwatch UI.
* The [Ops Manager Health metric](metrics.html#opsman) is not created and emitted.

<p class="note"><strong>Note</strong>: If this check was previously disabled via BOSH manifest prior to v1.1.4, you must explicitly disable it again via the Ops Manager UI.</p>

##<a id='healthwatch-uaa-users'></a> (Optional) Allow Additional Users to Access the PCF Healthwatch UI

Any user with the <code>healthwatch.read</code> scope can access the PCF Healthwatch UI. The UAA admin user has this scope by default.

To allow other users access to the Healthwatch UI, perform the following steps. This procedure adds the <code>healthwatch.read</code> scope to the desired UAA users using the uaac client.

1. Access the uaac client with `uaac target UAA-URL`.
1. Enter `uaac token client get UAA-ADMIN-CLIENT-USERNAME`. When prompted, enter the secret.
1. (Optional) Add new UAA users using `uaac user add NEW-USER-USERNAME --emails NEW-USER-EMAIL-ADDRESS`. When prompted, enter the password.
1. Enter `uaac member add healthwatch.read UAA-USERNAME` to add the scope to the user.
